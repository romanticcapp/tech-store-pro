<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<title>Product</title>
</head>

<body>

<nav>
<div class="logo">ðŸ”¥ Gaming Store</div>
</nav>

<div style="padding:40px" id="product"></div>


<script>

// Ù†Ø¬ÙŠØ¨ id Ù…Ù† Ø§Ù„Ù„ÙŠÙ†Ùƒ
const params = new URLSearchParams(location.search);
const id = params.get("id");

fetch("/api/products")
.then(r=>r.json())
.then(products=>{

const p = products.find(x=>x.id == id);

product.innerHTML=`

<div style="display:grid;
grid-template-columns:1fr 1fr;
gap:40px;
align-items:center;">

<img src="${p.images[0]}" 
style="width:100%;border-radius:20px;">

<div>

<h1>${p.name}</h1>

<p>${p.description || ""}</p>

${p.discount ? 
`<small style="text-decoration:line-through">
${p.price}
</small>` : ""}

<h2 style="color:#00ffcc">
${p.discount ? p.price-p.discount : p.price} Ø¬Ù†ÙŠÙ‡
</h2>

<p>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${p.stock}</p>

<div style="display:flex;gap:10px;align-items:center">

<button onclick="changeQty(-1)">-</button>

<h3 id="qty">1</h3>

<button onclick="changeQty(1)">+</button>

</div>

<button onclick="buyNow()">
Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†
</button>

</div>

</div>

`;

window.productData = p;

});

let quantity=1;

function changeQty(num){

quantity += num;

if(quantity<1) quantity=1;

qty.innerText=quantity;

}



function buyNow(){

const name = prompt("Ø§Ø³Ù…Ùƒ");
const phone = prompt("Ø±Ù‚Ù…Ùƒ");
const address = prompt("Ø¹Ù†ÙˆØ§Ù†Ùƒ");

if(!name || !phone || !address){
alert("Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");
return;
}

fetch("/api/orders",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
customer:{
name,
phone,
address
},
cart:[{
...productData,
qty:quantity
}]
})
});

alert("ØªÙ… Ø§Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ðŸ”¥");

}

</script>

</body>
</html>
