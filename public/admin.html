<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="style.css">
<title>ADMIN</title>

<style>

.login{
display:flex;
justify-content:center;
align-items:center;
height:100vh;
flex-direction:column;
}

.tabs{
display:flex;
gap:20px;
padding:20px;
}

.tabBtn{
flex:1;
padding:15px;
font-size:18px;
}

.panel{
padding:20px;
}

input,textarea{
display:block;
width:100%;
margin:10px 0;
padding:10px;
border-radius:10px;
border:none;
background:#020617;
color:white;
border:1px solid #00ffcc44;
}

.productCard{
background:#020617;
padding:10px;
margin:10px 0;
border-radius:10px;
}

</style>
</head>

<body>

<!-- LOGIN -->

<div class="login" id="login">

<h2>ğŸ” Admin Login</h2>

<input id="code" placeholder="Ø§Ù„ÙƒÙˆØ¯">

<button onclick="login()">Ø¯Ø®ÙˆÙ„</button>

</div>



<!-- PANEL -->

<div id="panel" style="display:none">

<div class="tabs">

<button class="tabBtn" onclick="openTab('add')">
â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬
</button>

<button class="tabBtn" onclick="openTab('products')">
ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
</button>

<button class="tabBtn" onclick="openTab('orders')">
ğŸ§¾ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
</button>

<button class="tabBtn" onclick="openTab('discount')">
ğŸ’¸ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª
</button>

</div>


<div class="panel" id="add">

<h2>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h2>

<input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
<input id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<input id="discount" placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…">
<input id="stock" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø·Ø¹">
<textarea id="description" placeholder="Ø§Ù„ÙˆØµÙ"></textarea>

<input type="file" id="images" multiple>

<button onclick="addProduct()">
Ø§Ø¶Ø§ÙØ©
</button>

</div>


<div class="panel" id="products" style="display:none"></div>

<div class="panel" id="orders" style="display:none"></div>

<div class="panel" id="discount" style="display:none">
<h2>Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª ÙŠØªÙ… Ø§Ø¶Ø§ÙØªÙ‡Ø§ ÙˆÙ‚Øª Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù†ØªØ¬ ğŸ‘</h2>
</div>

</div>


<script>

// ğŸ” LOGIN

function login(){

fetch("/admin-login",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
code:code.value
})
})
.then(r=>r.json())
.then(d=>{

if(d.success){

login.style.display="none";
panel.style.display="block";

loadProducts();
loadOrders();

}else{
alert("Ø§Ù„ÙƒÙˆØ¯ ØºÙ„Ø·");
}

});

}



// TABS

function openTab(id){

document.querySelectorAll(".panel")
.forEach(p=>p.style.display="none");

document.getElementById(id)
.style.display="block";

}



// ğŸ”¥ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ± Base64

function toBase64(file){

return new Promise(resolve=>{

const reader = new FileReader();

reader.readAsDataURL(file);

reader.onload = ()=> resolve(reader.result);

});

}



// â• ADD PRODUCT

async function addProduct(){

let imgs=[];

for(let file of images.files){
imgs.push(await toBase64(file));
}

fetch("/api/products",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({

name:name.value,
price:Number(price.value),
discount:Number(discount.value),
stock:Number(stock.value),
description:description.value,
images:imgs

})
})
.then(()=>{

alert("ØªÙ… Ø§Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ ğŸ”¥");

loadProducts();

});

}



// ğŸ“¦ LOAD PRODUCTS

function loadProducts(){

fetch("/api/products")
.then(r=>r.json())
.then(data=>{

products.innerHTML="<h2>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>";

data.forEach(p=>{

products.innerHTML+=`

<div class="productCard">

<img src="${p.images[0]}" width="60">

<b>${p.name}</b>

<br>
Ø§Ù„Ø³Ø¹Ø±: ${p.price}

<br>
Ø§Ù„Ø®ØµÙ…: ${p.discount}

<br>
Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ${p.stock}

<button onclick="deleteProduct(${p.id})">
Ø­Ø°Ù
</button>

</div>

`;

});

});

}



// âŒ DELETE

function deleteProduct(id){

fetch("/api/products/"+id,{
method:"DELETE"
})
.then(()=>loadProducts());

}



// ğŸ§¾ LOAD ORDERS

function loadOrders(){

fetch("/api/orders")
.then(r=>r.json())
.then(data=>{

orders.innerHTML="<h2>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>";

data.forEach(o=>{

orders.innerHTML+=`

<div class="productCard">

<b>ğŸ‘¤ ${o.customer.name}</b>

<br>
ğŸ“ ${o.customer.phone}

<br>
ğŸ“ ${o.customer.address}

<hr>

${o.cart.map(p=>`
<p>${p.name} x ${p.qty}</p>
`).join("")}

</div>

`;

});

});

}

</script>

</body>
  </html>
